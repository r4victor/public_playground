# k-ый элемент (kth element)

На вход подается массив A[0..n-1] различных элементов и индекс k: 0<=k<=n-1.

Необходимо вернуть k-ую порядковую статистику A (k-ый по величине элемент A).

## Тривиальное решение

Задача может быть решена сортировкой:

```python
def kth_element_reference_implementation(array, k):
    return sorted(array)[k]
```

## Quickselect

Quickselect – это рандомизированный алгоритм, который решает задачу в среднем за O(n). На каждой итерации алгоритм случайно выбирает элемент x массива и разбивает массив на три части:

1. элементы меньшие x
2. x
3. элементы большие x

Если индекс x после разбиения равен k, то x и есть k-ый элемент. Если k-ый элемент попадает в первую часть, то алгоритм рекурсивно ищет его там. Аналогично, если k-ый элемент попадает во вторую часть, то алгоритм рекурсивно ищет k-p-1-ый элемент во второй части (p – новый индекс x).

По сути это Quicksort, который не совершает лишние действия для нахождения k-ого элемента.

## Оценка времени работы

В худшем случае Quickselect работает за O(n^2). Это происходит когда, например, k=0 и на каждой итерации выбирается наибольший элемент. Время работы в этом случае c(n+(n-1)+...+1) = cn(n+1)/2.

Ожидаемое время работы (максимум мат.ожидания) – O(n). Можно доказать по индукции.